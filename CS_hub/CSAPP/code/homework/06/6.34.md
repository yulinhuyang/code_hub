# 6.34

dst 数组

| | C0 | C1 | C2 | C3
 :-:| :-:| :-:| :-:| :-:|
 R0| m|m|m|m
 R1| m|m|m|m
 R2| m|m|m|m
 R3| m|m|m|m

 src 数组

| | C0 | C1 | C2 | C3
 :-:| :-:| :-:| :-:| :-:|
 R0| m|m|h|m
 R1| m|h|m|h
 R2| m|m|h|m
 R3| m|h|m|h

## 解题思路

如果不访问 dst 的话，src 中的命中情况应该是这样的。

| | C0 | C1 | C2 | C3
 :-:| :-:| :-:| :-:| :-:|
 R0| m|h|h|h
 R1| m|h|h|h
 R2| m|h|h|h
 R3| m|h|h|h

现在需要访问 dst 了，当 j%2 = i%2 时，dst[j] 会替换掉 src[i] 刚刚更新的缓存行，导致下次访问 `src[i][j+1]` 时会不命中。于是上边表格中，所有 j%2 = i%2 格子右边格子中的 h 都要变成 m，如下图所示

| | C0 | C1 | C2 | C3
 :-:| :-:| :-:| :-:| :-:|
 R0| m|~~h~~ m|h|~~h~~ m
 R1| m|h|~~h~~ m|h
 R2| m|~~h~~ m|h|~~h~~ m
 R3| m|h|~~h~~ m|h

另一方，就算不需要访问 src，按照程序中，先列后行的方式访问一遍 dst，也是全部都不命中。所以，dst 数组中，全部都是 m